\chapter{An introduction to geometric measure theory }

In this chapter, we study the links between the topology and geometry of \( \mathbb{R} \) and the Lebesgue measure. We first give two examples of how the two structures agree, and one example of how they don't.

\paragraph{Isometries.} Consider the group \( \Isom \mathbb{R} \) of the isometries of \( \mathbb{R} \) with the euclidean metric. One easily shows that this group consists of functions of the form
\[ 
    x + a \text{ or } a-x
\]
for \( a \in \mathbb{R} \). The Lebesgue measure is invariant on transformations \( g \in \Isom \mathbb{R} \), i.e.
\[ 
    \lambda(gA) =\lambda(A)
\]
for all measurable \( A \subseteq \mathbb{R} \). A corollary of this is that the Lebesgue measure is invariant w.r.t. the addition operation on \( \mathbb{R} \), which gives the reals the structure of a topological group.

\paragraph{Affine transformations.} Similarly to the above, the Lebesque measure work well with the action of the affine transformation group \( \Aff \mathbb{R} \). Directly from the definition, the group of affine transformations consists of the functions
\[ 
    g_{a, b} (x) := ax + b
\]
for \( r \neq 0 \), and the interaction with measure is given by
\[ 
    \lambda( g_{a,b} A ) = \lvert a \rvert \cdot \lambda( A ) .
\]

\paragraph{Topology.} There is a disconnect between the topological (nonempty interior) and measure-theoretic (positive measure) notions of \emph{large} or \emph{non-negligable} -- the topological notion is strictly stronger! Indeed, a set with nonempty interior has positive measure, but if we enumerate the rationals as
\[ 
    \mathbb{Q} = \{ q_1, q_2, \ldots \}
\]
the set
\[ 
    \mathbb{R} \setminus \bigcup_{n=1}^\infty (q_n - \frac{\varepsilon}{2^{n+1}},q_n + \frac{\varepsilon}{2^{n+1}} )  
\]
has comeasure \( \varepsilon \), but is nowhere dense.

However, there does exist a link between the two notions. It is a bit more subtle.

\begin{defn}
    Fix a measurable set \( A \subseteq \mathbb{R} \). A point \( x \in \mathbb{R} \) is called a \textbf{density point} iff
    \[ 
        \lim_{\delta \to 0^+} \frac{\lambda(A \cap B(x, \delta))}{2\delta} = 1.
   \]
   The \( 2\delta \) in the numerator is of course \( \lambda(B(x, \delta)) \).
\end{defn}
\begin{defn}
    The set of density points of \( A \) will be denoted \( \phi(A) \).
\end{defn}


Note that a density point is by neccesity an accumulation point. The promised link between geometry, measure and topology is provided by the theorem below.
\begin{thm}[Lebesgue Density Theorem]
    \label{LebesgueDensityTheorem}
    \hypertarget{LebesgueDensityTheorem}
    Let \( A \subseteq \mathbb{R} \) be a measurable set. Then almost all points of \( A \) are density points~of~\( A \) in the sense that 
    \ankimark
    \[ 
       \lambda^* (A \setminus \phi(A)) = 0. 
   \]
\end{thm}

\paragraph{Remark.} Note that the theorem follows trivially for null sets. Also, for a given \( A \), we may as well apply the theorem to \( A^c \) to get that almost all points outside of \( A \) have density \( 0 \).
\\

For the proof of the \textbf{Lebesgue Density Theorem}, we will need a tool, which we introduce now and prove later.
%TOOD: does the set have to be measurable?
\begin{defn}
    A family \(\mathcal{J} \) of nontrivial closed intervals is called a \textbf{Vitali cover} of a set \( A \) (not necessarily measurable) if for any given \(\varepsilon > 0 \) and \( x \in A \) there is an interval \( J \in \mathcal{J} \) such that
    \[ 
       \diam J <\varepsilon \wedge x \in J.
   \]
   In particular
   \[ 
      A \subseteq \bigcup \mathcal{J}.
  \]
\end{defn}
\begin{thm}[Vitali Covering Theorem]
    \label{VitaliCoveringTheorem}
    \hypertarget{VitaliCoveringTheorem}
    If \( \mathcal{J} \) is a Vitali cover of \( A \), there exists a sequence of pariwaise disjoint segments \( J_n \in \mathcal{J} \) such that
    \ankimark
    \[ 
      \lambda \left( A \setminus \bigcup_n J_n \right) = 0.
   \]
\end{thm}

\paragraph{Why is this theorem useful?} Vitali's theorem may not sound very smart on first glance. Its strength lies in the \emph{disjointness} of the cover. If we go about choosing the cover \( J_n \) without any guarantees, we can for example choose
\[ 
    \bigcup_{q_n \in \mathbb{Q}} \left(q_n - \frac{\varepsilon}{2^{n+1}},\,q_n + \frac{\varepsilon }{2^{n+1}}\right) 
\]
and get stuck! We have only covered a subset of the reals of size \(\varepsilon \), but we cannot use any other segment by density of \( \mathbb{Q} \).
\begin{proof}[Proof of the Lebesgue Density Theorem]
    We represent
    \[ 
    A \setminus \phi(A) = \bigcup_k A_k      
   \]
   for
   \[ 
       A_k = \left\{ a \in A : \liminf_{\delta \to 0^+} \frac{\lambda(A \cap B(a,\delta))}{2\delta} < 1 - \frac{1}{k} \right\}.
  \]
  It suffices to show
  \[ 
     \lambda^*(A_k) = 0 
 \]
 for all \( k \) to finish the proof. Since we may represent \( A \) as
 \[ 
     A = \bigcup_{z \in \mathbb{Z}} A \cap [z-1, z+1] 
\]
and being a density point of \( A \) is the same as being a density point of one of the \emph{cutouts} in the sum above, we may assume without loss of generality that \( A \subseteq [0,1] \).

By definition of outer measure, we can approximate \( A_k \) from above by an open set \( U \) such that
\[ 
    \lambda^*(A_k) \leqslant \lambda(U) \leqslant \lambda^*(A_k) + \varepsilon.
\]
Construct a covering
\[ 
    \mathcal{J} = \left\{ [a,b] : [a,b] \subseteq U,\,\lambda\Bigl(A \cap [a,b]\Bigr) \leqslant \left(1 - \frac{1}{k}\right)\lambda[a,b]\right\}.
\]
It is a Vitali cover of \( A_k \). By \hyperlink{VitaliCoveringTheorem}{Vitali's Theorem} we can pick a pairwise disjoint sequence of intervals \( J_i \in \mathcal{J}\) for which
\[ 
    \lambda^*\left( A_k \setminus \bigcup_i\; J_i\right) = 0.
\]
This gives
\begin{align*}
    \lambda^* (A_k) &=\lambda^*\left(A_k \cap \bigcup_i \; J_i \right) \\
                    &\leqslant \sum_i \lambda^*(A_k \cap J_i ) \\
                    &\leqslant \sum_i \lambda^*(A \cap J_i ) \\
                    &\leqslant \left( 1 - \frac{1}{k} \right) \sum_i\lambda(J_i) \\
                    &\leqslant \left( 1 - \frac{1}{k} \right)\lambda(U) \\
                    &\leqslant \left( 1 - \frac{1}{k} \right) \left(\lambda^*(A_k) +\varepsilon \right).
\end{align*}
The passage from line 2 to 3 may seem trivial, but is in fact crucial. This is the place where we use \( A_k \subseteq A \)! Otherwise the theorem is quite absurd, even for simple examples like \( [0,1] \). Since \( \lambda^*(A_k) \leqslant\lambda(A) < \infty \), we can rearrange this to obtain
\[ 
   \lambda^*(A_k) \leqslant (k-1)\varepsilon. 
\]
Since \(\varepsilon \) can be picked arbitrarily close to 0, we get
\[ 
   \lambda^*(A_k) = 0. 
\]

\end{proof}

\begin{proof}[Proof of the Vitali Covering Theorem.]
    The key to avoiding the \emph{trap} we wrote about after stating the \hyperlink{VitaliCoveringTheorem}{VCT} is to choose the segments to be as large as possible -- or at least not embarassingly small.

    % Does this reduction work????
    Without loss of generality, \( A \) is bounded since we can sum the coverings of \( A \cap (n,n+1) \). The sequence of segments we pick is denoted \( J_n \). In that case we may also assume \( \bigcup \mathcal{J} \) is bounded. Its prefixes are
    \begin{align*}
        P_n &:= \bigcup_{i < n} J_i \\
        \mathcal{J}_n &:= \left\{ J \in \mathcal{J} : J \cap P_n = \varnothing \right\}
    \end{align*}
   and the \emph{width} of what we can choose is
    \[ 
        \gamma_n := \sup_{J \in \mathcal{J}_n} \diam J.
    \]
    Note that in particular
    \begin{align*}
        P_1 &= \varnothing, \\
        \mathcal{J}_1 &= \mathcal{J} \\
        \gamma_1 \leqslant &\diam A < \infty.
    \end{align*}
    At each step, we choose \( J_n \) so that
    \[ 
       \diam J_n \geqslant \frac{1}{2}\gamma_n,
   \]
   or we stop if \( \gamma_n = 0 \) at some point.
\paragraph{Claim 1.} The sequence \( \gamma_n \) converges monotonically to \( 0 \).
\begin{proof}[Proof of Claim 1.] Being the supremum of ever decreasing sets, \( \gamma_n \) is decreasing. It is also nonnegative, so the sequence converges and \( \lim_n \gamma_n \geqslant 0 \). Suppose that \( \lim_n \gamma_n = c > 0 \). Then in the construction, we would almost always choose disjoint intervals of diameter at least \( c/2 \). This is impossible, since \( \bigcup \mathcal{J} \) was assumed to be bounded, so it has finite measure!
\end{proof}

   The key to proving that the choice procedure is correct will be the \textbf{blowup}, which we define for \( J = [x-r,x+r] \) as
   \[ 
       \widetilde{J} :=  [x - 5r,\, x + 5r]
  \]
   \paragraph{Claim 2.} At all steps of the construction
   \[ 
       A \subseteq \mathcal{J}_n \cup \bigcup_{i \geqslant n} \widetilde{J}_i.
  \]
  \begin{proof}[Proof of Claim 2.]
      %TODO: get rid of that "is considered junk" with sensible notation.
      The set \( \mathcal{J}_n \) is closed as a union of closed intervals. Therefore, if \( a \in A  \setminus \mathcal{J}_n \), there is a nondegenerate interval \( I \ni a \). Since \( \gamma_n \to 0 \) by \textbf{Claim 1}, \( I \) is not considered in the construction of the sequence \( J_n \) for almost all \( n \). Let \( n_0 \) be the last step where it is considered. Then we must have \( I \cap J_{n_0 + 1} \neq 0\), because that is the step at which \( I \) is no longer considered.

      We will show that this implies \( a \in \widetilde{J}_{n_0 + 1} \). Let \( J_{n_0 + 1} = [x - r,\, x + r] \) and \( y \in I \cap J_{n_0 + 1} \). Then we have
      \begin{align*}
          d(a, x) &\leqslant d(a,y) + d(y,z) \\
                  &\leqslant \diam I + r \\
                  &\leqslant \left(  2\cdot \diam J_{n_0 + 1} \right)+ r \\
                  &= 2 \cdot 2r + r \\
                  &= 5r,
      \end{align*}
      where the diameter bound comes from the definition of \( \gamma_{n_0} \) and the fact that \( I \) is still available at step \( n_0 \) of the construction.
  \end{proof}
  
  To finish the proof of Vitali's Covering Theorem, we compute that for all \( n \)
  \begin{align*}
      \lambda^* \left( A \setminus P_n \right) &\leqslant\lambda^* \left( A \cap \bigcup_{i \geqslant n} \widetilde{J}_i \right) \\
                                               &\leqslant \lambda \left( \bigcup_{i \geqslant n} \widetilde{J}_i \right) \\
                                               &\leqslant \sum_{i \geqslant n}\lambda(\widetilde{J}_i) \\
                                               &= 5\sum_{i \geqslant n}\lambda(J_i).
  \end{align*}
  These are the tails of the convergent series
  \[ 
      \sum_{i=1}^{\infty}\lambda(J_i) =\lambda \left( \bigcup_i J_i \right) < \infty,
 \]
 so we get
 \[ 
  \lambda^* \left( A \setminus \bigcup_i J_i \right) \leqslant \lambda^* \left( A \setminus P_n \right) \to 0.
\]
\end{proof}

\paragraph{Remark.} Retracing the argument behind \textbf{Claim 2.}, we might prove that for any \( \alpha < 1 \), if we define \( \gamma_n \) with a coefficient of \( \alpha \) instead of \( \frac{1}{2} \), the constant used for blowing up intervals can be brought down to
\[ 
    1 + \frac{2}{\alpha}. 
\]
In particular, we can get arbitrarily close to \( 3 \).

\section{Corollaries and the Lebesgue Differentiation Theorem}

\begin{thm}[Lebesgue Differentiation Theorem]
    \label{LebesgueDifferentiationTheorem}
    \hypertarget{LebesgueDifferentiationTheorem}
    Let \( f \in L^1( \mathbb{R} ) \). Then, for almost all \( x \),
    \[ 
        \lim_{\delta \to 0^+} \frac{1}{2\delta} \int\limits_{x - \delta}^{x + \delta} f(s)\,\mathrm{d} \lambda(s) = f(x).
   \]
\end{thm}

\begin{proof}
    For characteristic functions, this is just a restatement of the \hyperlink{LebesgueDensityTheorem}{Lebesgue Density Theorem}.
\end{proof}

\section{Generalization to metric spaces}

The argument in the proof of the \hyperlink{VitaliCoveringTheorem}{VCT} was written so that it is easliy generalizable to any metric space with a measure on its Borel sets. 

To be more precise, what we need to lift the argument is that
\[ 
    \mu \left( B(x, 5r) \right) \leqslant C \mu \left( B(x,r) \right)
\]
for some constant \( C \). We can also substitute any constant larger that 3 instead of \( 5 \).

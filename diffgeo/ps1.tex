\begin{lemma}
    \label{DoubleChainRule}
    \hypertarget{DoubleChainRule}
    The second derivative of 
    \[
        g \circ f
    \]
    is given by
    \[
        (g''\circ f)\cdot (f')^2 + (g'\circ f) \cdot f''
    \]
\end{lemma}
\begin{proof}
    By the Chain Rule,
\[
    (g\circ f)' = f' \cdot (g' \circ f).
\]
    To take the derivative of this, we use the product rule and chain rule.
\end{proof}

\chapter{Differential Geometry, Problemset 1}

\section*{Problem 1}
Solved in the lecture.

\section*{Problem 2}
Solved in the lecture.

\section*{Problem 3}

By \ref{DoubleChainRule}, if the hypothesis holds for a curve \(\gamma\), it also holds for all reparametrizations. Therefore, we may assume that \(\gamma\) is parametrized by arclength. Denote the center of the circle as \(c\). We now have
\begin{align*}
    f(\gamma) &= \langle \gamma - c, \gamma - c \rangle - R^2 \\
    \frac{\mathrm{d}}{\mathrm{d}t} f(\gamma) &= 2\langle \dot\gamma, \gamma - c \rangle \\
    \frac{\mathrm{d^2}}{\mathrm{d}t^2} f(\gamma) &= 2\langle \ddot\gamma, \gamma - c \rangle + 2\langle \dot\gamma, \dot\gamma \rangle
\end{align*}

Now, \(f(\gamma) = 0\) iff \(\gamma(t) \in C(x, R)\). Then, the first derivative is 0 iff \(\dot\gamma\) is perpendicular to the radius of the circle. Note that the tangent to the circle has precisely this property, so this gives us equivalence of \(\gamma\) being tangent to the circle and the derivative of \(f(\gamma)\) being = 0.

For the third part, we assume arclength parametrization. Then the equation becomes
\[
0 = 1 + \langle \ddot\gamma, \gamma - c \rangle,
\]
which means that the length of \( \ddot\gamma \) must be \( \frac1R\) and its direction must be opposite to \(\gamma - c \), i.e. it must be directed toward the centre of the circle. This is true for the second derivative of the arclength parametrised circle, so the second derivative of \( f( \gamma ) \) is zero iff the second derivatives of \(\gamma\) and the arclength parametrization of the circle agree.

\section*{Problem 4} An equivalent definition:

\begin{defn}
    For an arclength-parametrized curve \(\gamma\), the circle of best fit to \(\gamma\) at \( s_0 \) is the unique tangent circle with the same signed curvature at the point of contact.
\end{defn}

Since any tangent circle has the same tangent, is also has the same positive normal (\(N(s)\)), and the second derivative is the curvature times the normal by definition of curvature \ref{PlanarCurvatureDefinition}.

\section*{Problem 6}

Assume the curve is parametrized by arclength. We will compute how the distance from the center of the circle changes along the curve. Let the circle have curvature \(\kappa\). Then the radius of the circle is \(1/\kappa\) and its center is the point
\[
\gamma(0) + \frac1\kappa N(0).
\]
Then, the vector from the centre to a point on the curve is
\[
r(s) := \gamma(s) - \gamma(0) - \frac1\kappa N(0).
\]
This is clearly not changed by translating the whole configuration, so without loss of generality \(\gamma(0) = 0\). In what follows, we use the dot product differentiation formula \ref{DotProductDifferentiation}.
\begin{align*}
    \frac{\mathrm{d}}{\mathrm{d}s} \lvert \lvert r(s) \rvert \rvert^2 &= \frac{\mathrm{d}}{\mathrm{d}s} \langle r(s), r(s) \rangle \\
                                                                      &=  2\langle \dot{r}(s), r(s) \rangle \\
                                                                      &= 2\langle \gamma(s), \dot{\gamma}(s))\rangle - 2\left\langle \frac1\kappa N(0), \dot{\gamma}(s)\right\rangle.
\end{align*}
At \( s = 0 \) both terms come out to \( 0 \), so we need to compute another derivative to see what is going on. We have
\begin{align*}
    \frac{\mathrm{d^2}}{\mathrm{d}s^2} \lvert \lvert r(s) \rvert \rvert^2 &= 4\langle \dot{\gamma}(s), \dot{\gamma}(s)\rangle + 4\langle \gamma(s), \ddot\gamma(s) \rangle - 4\left\langle \frac1\kappa N(0), \ddot\gamma (s) \right\rangle \\
                                                                      &=  4 + 4\langle \gamma(s), \ddot\gamma(s) \rangle - 4\frac{\kappa_\gamma(s)}{\kappa}\langle N(0), N(s) \rangle,
\end{align*}
where we have used \ref{ArclengthParametrisedVelocityOne} and \ref{FrenetEquation}. At \( s = 0 \) this comes out to
\[
    4 \left(1 - \frac{\kappa_\gamma(0)}{\kappa}\right),
\]
which is positive for \(\kappa_\gamma(0) < \kappa\) and negative for \( \kappa_\gamma(0) > \kappa \). This concludes the problem: for example, if the curve \(\gamma\) stays inside the circle (even locally!), then we cannot have \(\kappa_\gamma(0) < \kappa \), because then the distance would be increasing (by Taylor \ref{Taylor}).

\paragraph{Remark.} This still works for negative \( \kappa \). The only thing we need to check to make sure of that is that the center of the circle is where it is. It gets more tricky for \(\kappa = 0 \) -- in that case the appropriate reformulation of \emph{inside} and \emph{outside} is on one or the other side of the line, and instead of the distance we should consider
\[
\langle \gamma(s) - \gamma(0), N(0) \rangle.
\]
The derivative of this is
\[
2\langle \dot\gamma(s), N(0) \rangle, 
\]
which equals \(0\) at \(s = 0\). The second derivative is
\[
4\langle \ddot \gamma(s), N(0) \rangle = 4\kappa_\gamma(s) \langle N(s), N(0) \rangle
\]
by Frenet \ref{FrenetEquation}. At \(s\) this is just \( 4\kappa_\gamma(0) \), and analysing signs as above finishes the problem.

\section*{Problem 5}

Recall from Problem 6 that
\[
    \frac{\mathrm{d^2}}{\mathrm{d}s^2} \lvert \lvert r(s) \rvert \rvert^2 =  4 + 4\langle \gamma(s), \ddot\gamma(s) \rangle - 4\frac{\kappa_\gamma(s)}{\kappa}\langle N(0), N(s) \rangle
\]
and that the first derivative disappears at \( s = 0 \) for a tangent circle. For a circle of best fit, the curvature \( \kappa = \kappa_\gamma(0) \) (see my solution of Problem 4), so the second derivative disappears as well.
% TODO: Higher derivatives from Frenet!
% TODO: factoid -- derivative of signed distance disappears for a tangent dircle, and second derivative disappears for a circle of best fit
Computing the derivative of this
\begin{align*}
    \frac{\mathrm{d^3}}{\mathrm{d}s^3} \lvert \lvert r(s) \rvert \rvert^2 =  4\langle \gamma(s), \dddot\gamma(s) \rangle + 4\langle \dot\gamma(s), \ddot\gamma(s) \rangle - 4\frac{\kappa'_\gamma(s)}{\kappa}\langle N(0), N(s) \rangle - 4\frac{\kappa_\gamma(s)}{\kappa}\langle N(0), \dot N(s) \rangle
\end{align*}
For \( s = 0 \) this gives
\[
    \frac{\mathrm{d^3}}{\mathrm{d}s^3} \lvert \lvert r(s) \rvert \rvert^2 = -4\frac{\kappa'_\gamma(s)}{\kappa}.
\]
So, if the derivative is nonzero 

\section*{Problem 7}
I have a shitty calculatory solution, but nothing nice geometrically. It goes like
\begin{enumerate}
    \item Parametrize the points on the parabola by \( (p, p^2) \).
    \item Centers of tangent circles lie on \( p - 2pt, p^2 + pt \) and have radii \( t\sqrt{1 + 4p^2} \).
    \item Together with \( y = x^2 \) this gives an equation for the intersection points. Divided by \( (x - p)^2 \) the equation is
        \[
        1 + (x+p)^2 + 2t = 0.
        \]
    \item To avoid having two solutions, pick \(t\) so that \( x = p \) is a solution of this. Then, \( x = -3p \) is another solution (same value of the square).
    \item Caclulate that in this configuration
        \[
            t = -\frac{1+4p^2}{2}.
        \]
\item The tangent to the parabola at the chosen point is \( (1, -6p) \). The point is \( (-3p, 9p^2) \) and the center of the circle is \( (2p + 4p^3, -p^2 - 1/2) \). The vector from the circle to the point is then \((5p + 4p^3, -10p^2 -1/2) \).
\item The dot product between the tangent and the vector from the point to the center is a nonzero polynomial, so for almost all \( p \) the circle is not tangent.

\end{enumerate}

\section*{Problem 8}

% TODO: add picture of curve, which has increasing curvature whose range is the whole real line
Geometrically, the curve rolls into itself, like a spiral. Note that the curvature can also be negative or zero at some points, but increasing. In what follows, we consider a point of self-intersection.
\subsection{Non-zero curvature}
By the \ref{EvoluteDistanceFormula}, we know that if the curvature at some point is nonzero, then points in the direction of the absolute value of curvature are properly inside the osculating circle. Therefore, there can be no self-intersection at a point of nonzero curvature.

\subsection{Zero curvature}

For a point of zero curvature, we know from the remark to problem 6 that the first derivative of the signed distance from the line (which is the osculating circle at a point of curvature 0) is 0 and the second derivative is strictly positive after the point of zero curvature and strictly negative before (in a small neighbourhood!).

Taking points arbitrarily close to zero, we see that

TO BE CONTINUED!


\section*{Problem 9}
